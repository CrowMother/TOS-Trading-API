from Modules import streamer
from Modules import trade_processing as Data
import json
import re



def send_test_trade_order():
    testList = [
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729173630666,"command":"SUBS","content":[{"seq":1,"key":"Account Activity","1":"54661285","2":"OrderCreated","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderCreated\",\"OrderCreatedEventEquityOrder\":{\"EventType\":\"OrderCreated\",\"Order\":{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"Order\":{\"AccountInfo\":{\"AccountNumber\":\"54661285\",\"AccountBranch\":\"WT\",\"CustomerOrFirmCode\":\"CustomerOrFirmCode_Customer\",\"OrderPlacementCustomerID\":\"353286754\",\"AccountState\":\"MO\",\"AccountTypeCode\":\"Customer\"},\"ClientChannelInfo\":{\"ClientProductCode\":\"M1\",\"EventUserID\":\"O1XX\",\"EventUserType\":\"Client\"},\"LifecycleCreatedTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"LifecycleSchwabOrderID\":\"1001911402440\",\"EntryTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-17\"},\"AutoConfirm\":true,\"PlanSubmitDate\":{\"DateTimeString\":\"2024-10-17\"},\"SourceOMS\":\"ngOMS\",\"FirmID\":\"CHAS\",\"OrderAccount\":\"TDAAccount\",\"AssetOrderEquityOrderLeg\":{\"OrderInstruction\":{\"HandlingInstructionCode\":\"AutomatedExecutionNoIntervention\",\"ExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitPrice\":{\"lo\":\"1540000\",\"signScale\":12},\"LimitPriceUnitCode\":\"Units\"}},\"PreferredRoute\":{},\"EquityOrderInstruction\":{}},\"CommissionInfo\":{\"EstimatedOrderQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"EstimatedPrincipalAmount\":{\"lo\":\"154000000\",\"signScale\":12},\"EstimatedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"AssetType\":\"MajorAssetType_EquityOption\",\"TimeInForce\":\"Day\",\"OrderTypeCode\":\"Limit\",\"OrderLegs\":[{\"LegID\":\"1001911402440\",\"LegParentSchwabOrderID\":\"1001911402440\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"QuantityUnitCodeType\":\"SharesOrUnits\",\"LeavesQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"BuySellCode\":\"Sell\",\"Security\":{\"SchwabSecurityID\":\"91344348\",\"Symbol\":\"MARA  250117C00027000\",\"UnderlyingSymbol\":\"MARA\",\"MajorAssetType\":\"MajorAssetType_EquityOption\",\"PrimaryMarketSymbol\":\"MARA  250117C00027000\",\"ShortDescriptionText\":\"MARA HLDGS INC 01\/17\/2025 $27 Call\",\"ShortName\":\"MARA HLDGS INC 01\/17\/2025 $27 Call\",\"CUSIP\":\"0MARA.AH50027000\",\"OptionsSecurityInfo\":{\"PutCallCode\":\"Call\",\"UnderlyingSchwabSecurityID\":\"70833997\",\"StrikePrice\":{\"lo\":\"27000000\",\"signScale\":12},\"OptionExpiryDate\":{\"DateTimeString\":\"2025-01-17 00:00:00.000\"}}},\"QuoteOnOrderAcceptance\":{\"Ask\":{\"lo\":\"1560000\",\"signScale\":12},\"AskSize\":{\"lo\":\"154\"},\"Bid\":{\"lo\":\"1520000\",\"signScale\":12},\"BidSize\":{\"lo\":\"61\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"Symbol\":\"MARA  250117C00027000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"1540000\",\"signScale\":13},\"SchwabOrderID\":\"1001911402440\",\"OptionsQuote\":{\"PutCallCode\":\"Call\"}},\"LegClientRequestInfo\":{\"SecurityId\":\"MARA  250117C00027000\",\"SecurityIdTypeCd\":\"Symbol\"},\"AccountingRuleCode\":\"Cash\",\"EstimatedNetAmount\":{\"lo\":\"153350000\",\"signScale\":12},\"EstimatedPrincipalAmnt\":{\"lo\":\"154000000\",\"signScale\":12},\"EquityOrderLeg\":{\"EquityOptionsOrderLeg\":{\"OpenClosePositionCode\":\"PC_Close\"}}}],\"OrderCapacityCode\":\"OC_Agency\",\"SettlementType\":\"SettlementType_Regular\",\"Rule80ACode\":73,\"SolicitedCode\":\"Unsolicited\",\"TradeTag\":\"API_TOS:POS_STMT\",\"EquityOrder\":{\"TradingSessionCodeOnOrder\":\"REG\"}}}}}}}"}]}]}',
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729173631678,"command":"SUBS","content":[{"seq":2,"key":"Account Activity","1":"54661285","2":"OrderAccepted","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderAccepted\",\"OrderAcceptedEvent\":{\"EventType\":\"OrderAccepted\",\"CreatedTimeStamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-17\"},\"Status\":\"Open\",\"TradingSessionCodeOnOrderEntry\":\"REG\",\"QuoteOnOrderEntry\":[{\"Ask\":{\"lo\":\"1560000\",\"signScale\":12},\"AskSize\":{\"lo\":\"154\"},\"Bid\":{\"lo\":\"1520000\",\"signScale\":12},\"BidSize\":{\"lo\":\"61\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"Symbol\":\"MARA  250117C00027000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"1540000\",\"signScale\":13},\"SchwabOrderID\":\"1001911402440\",\"OptionsQuote\":{\"PutCallCode\":\"Call\"}}]}}}"},{"seq":3,"key":"Account Activity","1":"54661285","2":"ExecutionRequested","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequested\",\"ExecutionRequestedEventRoutedInfo\":{\"EventType\":\"ExecutionRequested\",\"RouteSequenceNumber\":1,\"RouteInfo\":{\"RouteName\":\"CES_OPT_F2_J1\",\"RouteSequenceNumber\":1,\"RoutedExecutionTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.609\"},\"Quote\":{\"Ask\":{\"lo\":\"1560000\",\"signScale\":12},\"AskSize\":{\"lo\":\"154\"},\"Bid\":{\"lo\":\"1520000\",\"signScale\":12},\"BidSize\":{\"lo\":\"61\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.571\"},\"Symbol\":\"MARA  250117C00027000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"1540000\",\"signScale\":13},\"SchwabOrderID\":\"1001911402440\",\"OptionsQuote\":{\"PutCallCode\":\"Call\"}},\"RouteRequestedType\":\"New\",\"RoutedQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"RoutedPrice\":{\"lo\":\"1540000\",\"signScale\":12},\"RouteStatus\":\"RouteCreated\",\"ClientOrderID\":\"1001911402440.1\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-17 10:00:30.609\"},\"RouteTimeInForce\":\"Day\",\"RouteAcknowledgmentTimeStamp\":{}},\"RouteRequestedBy\":\"RR_Broker\",\"LegId\":\"1001911402440\"}}}"},{"seq":4,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCreated","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"ExecutionRequestCreatedEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"LegId\":\"1001911402440\",\"RouteName\":\"CES_OPT_F2_J1\",\"RouteRequestType\":\"New\",\"RouteSequenceNumber\":1,\"RouteRequestedBy\":\"RR_Broker\",\"RouteStatus\":\"RouteFixAcknowledged\",\"SenderCompID\":\"CHASOPT\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-17 10:00:30.635\"},\"ClientOrderID\":\"1001911402440.1\"}}}"},{"seq":5,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCompleted","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"ExecutionRequestCompletedEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"LegId\":\"1001911402440\",\"ResponseType\":\"Accepted\",\"ExecutionTime\":{\"DateTimeString\":\"2024-10-17 10:00:30.737\"},\"RouteSequenceNumber\":1,\"RouteStatus\":\"RouteVenueAccepted\",\"RouteAcknowledgmentTimeStamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.704\"},\"ClientOrderID\":\"1001911402440.1\"}}}"},{"seq":6,"key":"Account Activity","1":"54661285","2":"OrderFillCompleted","3":"{\"SchwabOrderID\":\"1001911402440\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderFillCompleted\",\"OrderFillCompletedEventOrderLegQuantityInfo\":{\"EventType\":\"OrderFillCompleted\",\"LegId\":\"1001911402440\",\"LegStatus\":\"LegClosed\",\"QuantityInfo\":{\"ExecutionID\":\"20241017-EST-ngOMS-13421749025\",\"CumulativeQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"LeavesQuantity\":{\"signScale\":12},\"AveragePrice\":{\"lo\":\"1540000\",\"signScale\":12}},\"PriceImprovement\":{\"signScale\":12},\"LegSubStatus\":\"LegSubStatusFilled\",\"ExecutionInfo\":{\"ExecutionSequenceNumber\":1,\"ExecutionId\":\"20241017-EST-ngOMS-13421749025\",\"VenueExecutionID\":\"OPT900110055\",\"Exchange\":\"CBOE\",\"ExecutionQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"ExecutionPrice\":{\"lo\":\"1540000\",\"signScale\":12},\"ExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.844\"},\"ExecutionTransType\":\"Fill\",\"ExecutionCapacityCode\":\"Agency\",\"RouteName\":\"CES_OPT_F2_J1\",\"RouteSequenceNumber\":1,\"VenuExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-17 10:00:30.809\"},\"ReportingCapacityCode\":\"RC_Agency\",\"ActualChargedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12},\"AsOfTimeStamp\":{},\"ActualChargedFeesCommissionAndTax\":{\"StateTaxWithholding\":{\"signScale\":12},\"FederalTaxWithholding\":{\"signScale\":12},\"SECFees\":{\"signScale\":12},\"ORF\":{\"lo\":\"10000\",\"signScale\":12},\"FTT\":{\"signScale\":12},\"TaxWithholding1446\":{\"signScale\":12},\"GoodsAndServicesTax\":{\"signScale\":12},\"IOF\":{\"signScale\":12},\"TAF\":{\"signScale\":12},\"CommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"ClientOrderID\":\"1001911402440.1\"},\"OrderInfoForTransactionPosting\":{\"LimitPrice\":{\"lo\":\"1540000\",\"signScale\":12},\"OrderTypeCode\":\"Limit\",\"OpenClosePositionCode\":\"PC_Close\",\"BuySellCode\":\"Sell\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"StopPrice\":{},\"Symbol\":\"MARA  250117C00027000\",\"SchwabSecurityID\":\"91344348\",\"SolicitedCode\":\"Unsolicited\",\"AccountingRuleCode\":\"Cash\",\"SettlementType\":\"SettlementType_Regular\",\"OrderCreatedUserID\":\"O1XX\",\"OrderCreatedUserType\":\"Venue\",\"ClientProductCode\":\"N1\"}}}}"}]}]}',
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729182169346,"command":"SUBS","content":[{"seq":49,"key":"Account Activity","1":"54661285","2":"OrderCreated","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderCreated\",\"OrderCreatedEventEquityOrder\":{\"EventType\":\"OrderCreated\",\"Order\":{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"Order\":{\"AccountInfo\":{\"AccountNumber\":\"54661285\",\"AccountBranch\":\"WT\",\"CustomerOrFirmCode\":\"CustomerOrFirmCode_Customer\",\"OrderPlacementCustomerID\":\"353286754\",\"AccountState\":\"MO\",\"AccountTypeCode\":\"Customer\"},\"ClientChannelInfo\":{\"ClientProductCode\":\"M1\",\"EventUserID\":\"O1XX\",\"EventUserType\":\"Client\"},\"LifecycleCreatedTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"LifecycleSchwabOrderID\":\"1001915856973\",\"EntryTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-17\"},\"AutoConfirm\":true,\"PlanSubmitDate\":{\"DateTimeString\":\"2024-10-17\"},\"SourceOMS\":\"ngOMS\",\"FirmID\":\"CHAS\",\"OrderAccount\":\"TDAAccount\",\"AssetOrderEquityOrderLeg\":{\"OrderInstruction\":{\"HandlingInstructionCode\":\"AutomatedExecutionNoIntervention\",\"ExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitPrice\":{\"lo\":\"400000\",\"signScale\":12},\"LimitPriceUnitCode\":\"Units\"}},\"PreferredRoute\":{},\"EquityOrderInstruction\":{}},\"CommissionInfo\":{\"EstimatedOrderQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"EstimatedPrincipalAmount\":{\"lo\":\"40000000\",\"signScale\":13},\"EstimatedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"AssetType\":\"MajorAssetType_EquityOption\",\"TimeInForce\":\"Day\",\"OrderTypeCode\":\"Limit\",\"OrderLegs\":[{\"LegID\":\"1001915856973\",\"LegParentSchwabOrderID\":\"1001915856973\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"QuantityUnitCodeType\":\"SharesOrUnits\",\"LeavesQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"BuySellCode\":\"Buy\",\"Security\":{\"SchwabSecurityID\":\"102793864\",\"Symbol\":\"NFLX  241025P00550000\",\"UnderlyingSymbol\":\"NFLX\",\"MajorAssetType\":\"MajorAssetType_EquityOption\",\"PrimaryMarketSymbol\":\"NFLX  241025P00550000\",\"ShortDescriptionText\":\"NETFLIX INC 10\/25\/2024 $550 Put\",\"ShortName\":\"NETFLIX INC 10\/25\/2024 $550 Put\",\"CUSIP\":\"0NFLX.VP40550000\",\"OptionsSecurityInfo\":{\"PutCallCode\":\"Put\",\"UnderlyingSchwabSecurityID\":\"231673095\",\"StrikePrice\":{\"lo\":\"550000000\",\"signScale\":12},\"OptionExpiryDate\":{\"DateTimeString\":\"2024-10-25 00:00:00.000\"}}},\"QuoteOnOrderAcceptance\":{\"Ask\":{\"lo\":\"420000\",\"signScale\":12},\"AskSize\":{\"lo\":\"49\"},\"Bid\":{\"lo\":\"390000\",\"signScale\":12},\"BidSize\":{\"lo\":\"2\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"405000\",\"signScale\":12},\"SchwabOrderID\":\"1001915856973\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}},\"LegClientRequestInfo\":{\"SecurityId\":\"NFLX  241025P00550000\",\"SecurityIdTypeCd\":\"Symbol\"},\"AccountingRuleCode\":\"Cash\",\"EstimatedNetAmount\":{\"lo\":\"40650000\",\"signScale\":13},\"EstimatedPrincipalAmnt\":{\"lo\":\"40000000\",\"signScale\":13},\"EquityOrderLeg\":{\"EquityOptionsOrderLeg\":{\"OpenClosePositionCode\":\"PC_Open\"}}}],\"OrderCapacityCode\":\"OC_Agency\",\"SettlementType\":\"SettlementType_Regular\",\"Rule80ACode\":73,\"SolicitedCode\":\"Unsolicited\",\"TradeTag\":\"API_TOS:TRADE_ALL\",\"EquityOrder\":{\"TradingSessionCodeOnOrder\":\"REG\"}}}}}}}"}]}]}',
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729182170381,"command":"SUBS","content":[{"seq":50,"key":"Account Activity","1":"54661285","2":"OrderAccepted","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderAccepted\",\"OrderAcceptedEvent\":{\"EventType\":\"OrderAccepted\",\"CreatedTimeStamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-17\"},\"Status\":\"Open\",\"TradingSessionCodeOnOrderEntry\":\"REG\",\"QuoteOnOrderEntry\":[{\"Ask\":{\"lo\":\"420000\",\"signScale\":12},\"AskSize\":{\"lo\":\"49\"},\"Bid\":{\"lo\":\"390000\",\"signScale\":12},\"BidSize\":{\"lo\":\"2\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"405000\",\"signScale\":12},\"SchwabOrderID\":\"1001915856973\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}}]}}}"},{"seq":51,"key":"Account Activity","1":"54661285","2":"ExecutionRequested","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequested\",\"ExecutionRequestedEventRoutedInfo\":{\"EventType\":\"ExecutionRequested\",\"RouteSequenceNumber\":1,\"RouteInfo\":{\"RouteName\":\"CES_OPT_F2_J1\",\"RouteSequenceNumber\":1,\"RoutedExecutionTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.265\"},\"Quote\":{\"Ask\":{\"lo\":\"420000\",\"signScale\":12},\"AskSize\":{\"lo\":\"49\"},\"Bid\":{\"lo\":\"390000\",\"signScale\":12},\"BidSize\":{\"lo\":\"2\"},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.221\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"405000\",\"signScale\":12},\"SchwabOrderID\":\"1001915856973\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}},\"RouteRequestedType\":\"New\",\"RoutedQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"RoutedPrice\":{\"lo\":\"400000\",\"signScale\":12},\"RouteStatus\":\"RouteCreated\",\"ClientOrderID\":\"1001915856973.1\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-17 12:22:49.265\"},\"RouteTimeInForce\":\"Day\",\"RouteAcknowledgmentTimeStamp\":{}},\"RouteRequestedBy\":\"RR_Broker\",\"LegId\":\"1001915856973\"}}}"},{"seq":52,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCreated","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"ExecutionRequestCreatedEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"LegId\":\"1001915856973\",\"RouteName\":\"CES_OPT_F2_J1\",\"RouteRequestType\":\"New\",\"RouteSequenceNumber\":1,\"RouteRequestedBy\":\"RR_Broker\",\"RouteStatus\":\"RouteFixAcknowledged\",\"SenderCompID\":\"CHASOPT\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-17 12:22:49.296\"},\"ClientOrderID\":\"1001915856973.1\"}}}"},{"seq":53,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCompleted","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"ExecutionRequestCompletedEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"LegId\":\"1001915856973\",\"ResponseType\":\"Accepted\",\"ExecutionTime\":{\"DateTimeString\":\"2024-10-17 12:22:49.395\"},\"RouteSequenceNumber\":1,\"RouteStatus\":\"RouteVenueAccepted\",\"RouteAcknowledgmentTimeStamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.363\"},\"ClientOrderID\":\"1001915856973.1\"}}}"},{"seq":54,"key":"Account Activity","1":"54661285","2":"OrderFillCompleted","3":"{\"SchwabOrderID\":\"1001915856973\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderFillCompleted\",\"OrderFillCompletedEventOrderLegQuantityInfo\":{\"EventType\":\"OrderFillCompleted\",\"LegId\":\"1001915856973\",\"LegStatus\":\"LegClosed\",\"QuantityInfo\":{\"ExecutionID\":\"20241017-EST-ngOMS-13423753509\",\"CumulativeQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"LeavesQuantity\":{\"signScale\":12},\"AveragePrice\":{\"lo\":\"400000\",\"signScale\":12}},\"PriceImprovement\":{\"signScale\":12},\"LegSubStatus\":\"LegSubStatusFilled\",\"ExecutionInfo\":{\"ExecutionSequenceNumber\":1,\"ExecutionId\":\"20241017-EST-ngOMS-13423753509\",\"VenueExecutionID\":\"OPT1125310344\",\"Exchange\":\"MIAX\",\"ExecutionQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"ExecutionPrice\":{\"lo\":\"400000\",\"signScale\":12},\"ExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.502\"},\"ExecutionTransType\":\"Fill\",\"ExecutionCapacityCode\":\"Agency\",\"RouteName\":\"CES_OPT_F2_J1\",\"RouteSequenceNumber\":1,\"VenuExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-17 12:22:49.468\"},\"ReportingCapacityCode\":\"RC_Agency\",\"ActualChargedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12},\"AsOfTimeStamp\":{},\"ActualChargedFeesCommissionAndTax\":{\"StateTaxWithholding\":{\"signScale\":12},\"FederalTaxWithholding\":{\"signScale\":12},\"SECFees\":{\"signScale\":12},\"ORF\":{\"lo\":\"10000\",\"signScale\":12},\"FTT\":{\"signScale\":12},\"TaxWithholding1446\":{\"signScale\":12},\"GoodsAndServicesTax\":{\"signScale\":12},\"IOF\":{\"signScale\":12},\"TAF\":{\"signScale\":12},\"CommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"ClientOrderID\":\"1001915856973.1\"},\"OrderInfoForTransactionPosting\":{\"LimitPrice\":{\"lo\":\"400000\",\"signScale\":12},\"OrderTypeCode\":\"Limit\",\"OpenClosePositionCode\":\"PC_Open\",\"BuySellCode\":\"Buy\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"StopPrice\":{},\"Symbol\":\"NFLX  241025P00550000\",\"SchwabSecurityID\":\"102793864\",\"SolicitedCode\":\"Unsolicited\",\"AccountingRuleCode\":\"Cash\",\"SettlementType\":\"SettlementType_Regular\",\"OrderCreatedUserID\":\"O1XX\",\"OrderCreatedUserType\":\"Venue\",\"ClientProductCode\":\"N1\"}}}}"}]}]}',
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729276583492,"command":"SUBS","content":[{"seq":17,"key":"Account Activity","1":"54661285","2":"OrderCreated","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderCreated\",\"OrderCreatedEventEquityOrder\":{\"EventType\":\"OrderCreated\",\"Order\":{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"Order\":{\"AccountInfo\":{\"AccountNumber\":\"54661285\",\"AccountBranch\":\"WT\",\"CustomerOrFirmCode\":\"CustomerOrFirmCode_Customer\",\"OrderPlacementCustomerID\":\"353286754\",\"AccountState\":\"MO\",\"AccountTypeCode\":\"Customer\"},\"ClientChannelInfo\":{\"ClientProductCode\":\"M2\",\"EventUserID\":\"O2XX\",\"EventUserType\":\"Client\"},\"LifecycleCreatedTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"LifecycleSchwabOrderID\":\"1001931909525\",\"EntryTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-18\"},\"AutoConfirm\":true,\"PlanSubmitDate\":{\"DateTimeString\":\"2024-10-18\"},\"SourceOMS\":\"ngOMS\",\"FirmID\":\"CHAS\",\"OrderAccount\":\"TDAAccount\",\"AssetOrderEquityOrderLeg\":{\"OrderInstruction\":{\"HandlingInstructionCode\":\"AutomatedExecutionNoIntervention\",\"ExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitExecutionStrategy\":{\"Type\":\"ES_Limit\",\"LimitPrice\":{\"lo\":\"10000\",\"signScale\":12},\"LimitPriceUnitCode\":\"Units\"}},\"PreferredRoute\":{},\"EquityOrderInstruction\":{}},\"CommissionInfo\":{\"EstimatedOrderQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"EstimatedPrincipalAmount\":{\"lo\":\"1000000\",\"signScale\":12},\"EstimatedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"AssetType\":\"MajorAssetType_EquityOption\",\"TimeInForce\":\"Day\",\"OrderTypeCode\":\"Limit\",\"OrderLegs\":[{\"LegID\":\"1001931909525\",\"LegParentSchwabOrderID\":\"1001931909525\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"QuantityUnitCodeType\":\"SharesOrUnits\",\"LeavesQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"BuySellCode\":\"Sell\",\"Security\":{\"SchwabSecurityID\":\"102793864\",\"Symbol\":\"NFLX  241025P00550000\",\"UnderlyingSymbol\":\"NFLX\",\"MajorAssetType\":\"MajorAssetType_EquityOption\",\"PrimaryMarketSymbol\":\"NFLX  241025P00550000\",\"ShortDescriptionText\":\"NETFLIX INC 10\/25\/2024 $550 Put\",\"ShortName\":\"NETFLIX INC 10\/25\/2024 $550 Put\",\"CUSIP\":\"0NFLX.VP40550000\",\"OptionsSecurityInfo\":{\"PutCallCode\":\"Put\",\"UnderlyingSchwabSecurityID\":\"231673095\",\"StrikePrice\":{\"lo\":\"550000000\",\"signScale\":12},\"OptionExpiryDate\":{\"DateTimeString\":\"2024-10-25 00:00:00.000\"}}},\"QuoteOnOrderAcceptance\":{\"Ask\":{\"lo\":\"30000\",\"signScale\":12},\"AskSize\":{\"lo\":\"15\"},\"Bid\":{\"signScale\":12},\"BidSize\":{},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"15000\",\"signScale\":13},\"SchwabOrderID\":\"1001931909525\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}},\"LegClientRequestInfo\":{\"SecurityId\":\"NFLX  241025P00550000\",\"SecurityIdTypeCd\":\"Symbol\"},\"AccountingRuleCode\":\"Cash\",\"EstimatedNetAmount\":{\"lo\":\"350000\",\"signScale\":12},\"EstimatedPrincipalAmnt\":{\"lo\":\"1000000\",\"signScale\":12},\"EquityOrderLeg\":{\"EquityOptionsOrderLeg\":{\"OpenClosePositionCode\":\"PC_Close\"}}}],\"OrderCapacityCode\":\"OC_Agency\",\"SettlementType\":\"SettlementType_Regular\",\"Rule80ACode\":73,\"SolicitedCode\":\"Unsolicited\",\"TradeTag\":\"API_TOS:IPHONE\",\"EquityOrder\":{\"TradingSessionCodeOnOrder\":\"REG\"}}}}}}}"}]}]}',
        '{"data":[{"service":"ACCT_ACTIVITY", "timestamp":1729276584495,"command":"SUBS","content":[{"seq":18,"key":"Account Activity","1":"54661285","2":"OrderAccepted","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderAccepted\",\"OrderAcceptedEvent\":{\"EventType\":\"OrderAccepted\",\"CreatedTimeStamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"ExpiryTimeStamp\":{\"DateTimeString\":\"2024-10-18\"},\"Status\":\"Open\",\"TradingSessionCodeOnOrderEntry\":\"REG\",\"QuoteOnOrderEntry\":[{\"Ask\":{\"lo\":\"30000\",\"signScale\":12},\"AskSize\":{\"lo\":\"15\"},\"Bid\":{\"signScale\":12},\"BidSize\":{},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"15000\",\"signScale\":13},\"SchwabOrderID\":\"1001931909525\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}}]}}}"},{"seq":19,"key":"Account Activity","1":"54661285","2":"ExecutionRequested","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequested\",\"ExecutionRequestedEventRoutedInfo\":{\"EventType\":\"ExecutionRequested\",\"RouteSequenceNumber\":1,\"RouteInfo\":{\"RouteName\":\"SIG_OPT_F1_J1\",\"RouteSequenceNumber\":1,\"RoutedExecutionTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.431\"},\"Quote\":{\"Ask\":{\"lo\":\"30000\",\"signScale\":12},\"AskSize\":{\"lo\":\"15\"},\"Bid\":{\"signScale\":12},\"BidSize\":{},\"QuoteTimestamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.394\"},\"Symbol\":\"NFLX  241025P00550000\",\"QuoteTypeCode\":\"Mark\",\"Mid\":{\"lo\":\"15000\",\"signScale\":13},\"SchwabOrderID\":\"1001931909525\",\"OptionsQuote\":{\"PutCallCode\":\"Put\"}},\"RouteRequestedType\":\"New\",\"RoutedQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"RoutedPrice\":{\"lo\":\"10000\",\"signScale\":12},\"RouteStatus\":\"RouteCreated\",\"ClientOrderID\":\"1001931909525.1\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-18 14:36:23.431\"},\"RouteTimeInForce\":\"Day\",\"RouteAcknowledgmentTimeStamp\":{}},\"RouteRequestedBy\":\"RR_Broker\",\"LegId\":\"1001931909525\"}}}"},{"seq":20,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCreated","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"ExecutionRequestCreatedEvent\":{\"EventType\":\"ExecutionRequestCreated\",\"LegId\":\"1001931909525\",\"RouteName\":\"SIG_OPT_F1_J1\",\"RouteRequestType\":\"New\",\"RouteSequenceNumber\":1,\"RouteRequestedBy\":\"RR_Broker\",\"RouteStatus\":\"RouteFixAcknowledged\",\"SenderCompID\":\"CHAS3\",\"RoutedTime\":{\"DateTimeString\":\"2024-10-18 14:36:23.468\"},\"ClientOrderID\":\"1001931909525.1\"}}}"},{"seq":21,"key":"Account Activity","1":"54661285","2":"ExecutionRequestCompleted","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"ExecutionRequestCompletedEvent\":{\"EventType\":\"ExecutionRequestCompleted\",\"LegId\":\"1001931909525\",\"ResponseType\":\"Accepted\",\"ExecutionTime\":{\"DateTimeString\":\"2024-10-18 14:36:23.527\"},\"RouteSequenceNumber\":1,\"RouteStatus\":\"RouteVenueAccepted\",\"RouteAcknowledgmentTimeStamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.494\"},\"ClientOrderID\":\"1001931909525.1\"}}}"},{"seq":22,"key":"Account Activity","1":"54661285","2":"OrderFillCompleted","3":"{\"SchwabOrderID\":\"1001931909525\",\"AccountNumber\":\"54661285\",\"BaseEvent\":{\"EventType\":\"OrderFillCompleted\",\"OrderFillCompletedEventOrderLegQuantityInfo\":{\"EventType\":\"OrderFillCompleted\",\"LegId\":\"1001931909525\",\"LegStatus\":\"LegClosed\",\"QuantityInfo\":{\"ExecutionID\":\"20241018-EST-ngOMS-13431065082\",\"CumulativeQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"LeavesQuantity\":{\"signScale\":12},\"AveragePrice\":{\"lo\":\"10000\",\"signScale\":12}},\"PriceImprovement\":{\"signScale\":12},\"LegSubStatus\":\"LegSubStatusFilled\",\"ExecutionInfo\":{\"ExecutionSequenceNumber\":1,\"ExecutionId\":\"20241018-EST-ngOMS-13431065082\",\"VenueExecutionID\":\"20241018090281\",\"Exchange\":\"CBOE\",\"ExecutionQuantity\":{\"lo\":\"1000000\",\"signScale\":12},\"ExecutionPrice\":{\"lo\":\"10000\",\"signScale\":12},\"ExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.544\"},\"ExecutionTransType\":\"Fill\",\"ExecutionCapacityCode\":\"Agency\",\"RouteName\":\"SIG_OPT_F1_J1\",\"RouteSequenceNumber\":1,\"VenuExecutionTimeStamp\":{\"DateTimeString\":\"2024-10-18 14:36:23.500\"},\"ReportingCapacityCode\":\"RC_Agency\",\"ActualChargedCommissionAmount\":{\"lo\":\"650000\",\"signScale\":12},\"AsOfTimeStamp\":{},\"ActualChargedFeesCommissionAndTax\":{\"StateTaxWithholding\":{\"signScale\":12},\"FederalTaxWithholding\":{\"signScale\":12},\"SECFees\":{\"signScale\":12},\"ORF\":{\"lo\":\"10000\",\"signScale\":12},\"FTT\":{\"signScale\":12},\"TaxWithholding1446\":{\"signScale\":12},\"GoodsAndServicesTax\":{\"signScale\":12},\"IOF\":{\"signScale\":12},\"TAF\":{\"signScale\":12},\"CommissionAmount\":{\"lo\":\"650000\",\"signScale\":12}},\"ClientOrderID\":\"1001931909525.1\"},\"OrderInfoForTransactionPosting\":{\"LimitPrice\":{\"lo\":\"10000\",\"signScale\":12},\"OrderTypeCode\":\"Limit\",\"OpenClosePositionCode\":\"PC_Close\",\"BuySellCode\":\"Sell\",\"Quantity\":{\"lo\":\"1000000\",\"signScale\":12},\"StopPrice\":{},\"Symbol\":\"NFLX  241025P00550000\",\"SchwabSecurityID\":\"102793864\",\"SolicitedCode\":\"Unsolicited\",\"AccountingRuleCode\":\"Cash\",\"SettlementType\":\"SettlementType_Regular\",\"OrderCreatedUserID\":\"O2XX\",\"OrderCreatedUserType\":\"Venue\",\"ClientProductCode\":\"N1\"}}}}"}]}]}'
    ]
    
    for trade in testList:
        streamer.my_handler(trade)


